2022-03-30: Actually generate predicates.  Use Visitor instead of Listener?